# observability/prometheus-values.yaml

alertmanager:
  enabled: true
  alertmanagerSpec:
    replicas: 1
  service:
    type: NodePort
    nodePort: 30093
  
  # This is the part you were missing!
  config:
    global:
      resolve_timeout: 1m
    
    route:
      group_by: ['alertname', 'namespace']
      group_wait: 10s
      group_interval: 30s
      repeat_interval: 1h
      receiver: 'autoresolve-webhook'
      routes:
        - match:
            severity: critical
          receiver: 'autoresolve-webhook'
          group_wait: 0s
        - match:
            severity: warning
          receiver: 'autoresolve-webhook'
          group_wait: 10s

    receivers:
      - name: 'autoresolve-webhook'
        webhook_configs:
          # REPLACE THIS IP BELOW ðŸ‘‡
          - url: 'http://10.0.0.88:8000/webhook/alertmanager'
            send_resolved: true

grafana:
  adminPassword: autoresolve
  service:
    type: NodePort
    nodePort: 30080

prometheus:
  service:
    type: NodePort
    nodePort: 30090